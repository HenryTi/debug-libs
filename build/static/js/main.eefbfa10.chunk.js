(window.webpackJsonp=window.webpackJsonp||[]).push([[2],[,,,function(e,t,i){"use strict";(function(e){i.d(t,"b",function(){return m}),i.d(t,"a",function(){return w}),i.d(t,"c",function(){return C});var n=i(0),r=i(1),s=(i(27),i(20)),o=i(30),a=i(45),l=i(6),c=i(13),u=i(10),d=(i(33),i(46),i(63),i(65),i(11)),h=i(21),f=i(25),p=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},v=function(e,t,i,n){return new(i||(i=Promise))(function(r,s){function o(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(o,a)}l((n=n.apply(e,t||[])).next())})};const m=new RegExp("Android|webOS|iPhone|iPad|BlackBerry|Windows Phone|Opera Mini|IEMobile|Mobile","i").test(navigator.userAgent)?{minHeight:"3em"}:void 0;i(47);let g;const y=[];let b=1;class w extends n.Component{constructor(e){super(e),this.waitCount=0,this.isHistoryBack=!1,this.clearError=(()=>{this.setState({fetchError:void 0})}),this.back=this.back.bind(this),this.navBack=this.navBack.bind(this),this.stack=[],this.state={stack:this.stack,wait:0,fetchError:void 0}}componentWillMount(){return v(this,void 0,void 0,function*(){window.addEventListener("popstate",this.navBack)})}componentDidMount(){return v(this,void 0,void 0,function*(){C.set(this),yield C.start()})}get level(){return this.stack.length}startWait(){0===this.waitCount&&(this.setState({wait:1}),this.waitTimeHandler=e.setTimeout(()=>{this.waitTimeHandler=void 0,this.setState({wait:2})},1e3)),++this.waitCount,this.setState({fetchError:void 0})}endWait(){setTimeout(()=>{--this.waitCount,0===this.waitCount&&(void 0!==this.waitTimeHandler&&(clearTimeout(this.waitTimeHandler),this.waitTimeHandler=void 0),this.setState({wait:0}))},100)}onError(e){return v(this,void 0,void 0,function*(){let t=e.error;void 0===t||!0!==t.unauthorized?this.setState({fetchError:e}):yield C.showLogin()})}show(e,t){return this.clear(),this.push(e,t)}push(e,t){this.removeCeased(),this.stack.length>0&&window.history.pushState("forward",null,null);let i=b++;return this.stack.push({key:i,view:e,ceased:!1,disposer:t}),this.refresh(),i}replace(e,t){let i=void 0,n=this.stack;n.length>0&&(i=n.pop());let r=b++;return this.stack.push({key:r,view:e,ceased:!1,disposer:t}),void 0!==i&&this.dispose(i.disposer),this.refresh(),r}ceaseTop(e=1){let t=this.stack.length-1;for(let i=0;i<e&&!(t<0);i++,t--){this.stack[t].ceased=!0}}pop(e=1){let t=this.stack,i=t.length;if(e<=0||i<=1)return;i<e&&(e=i);let n=0;for(let r=0;r<e&&0!==t.length;r++)this.popAndDispose(),++n;n>=i&&n--,this.refresh(),this.isHistoryBack}popTo(e){throw new Error("to be designed")}removeCeased(){for(;;){let e=this.stack.length-1;if(e<0)break;if(!1===this.stack[e].ceased)break;let t=this.stack.pop(),{disposer:i}=t;this.dispose(i)}this.refresh()}popAndDispose(){this.removeCeased();let e=this.stack.pop();if(void 0===e)return;let{disposer:t}=e;return this.dispose(t),this.removeCeased(),e}dispose(e){if(void 0===e)return;void 0===this.stack.find(t=>t.disposer===e)&&e()}clear(){this.stack.length;for(;this.stack.length>0;)this.popAndDispose();this.refresh()}regConfirmClose(e){let t=this.stack,i=t.length;0!==i&&(t[i-1].confirmClose=e)}navBack(){C.log("backbutton pressed - nav level: "+this.stack.length),this.isHistoryBack=!0,this.back(!0),this.isHistoryBack=!1}back(e=!0){return v(this,void 0,void 0,function*(){let t=this.stack,i=t.length;if(0===i)return;if(1===i)return void(self!=window.top&&window.top.postMessage({type:"pop-app"},"*"));let n=t[i-1];!0===e&&n.confirmClose?!0===(yield n.confirmClose())&&this.pop():this.pop()})}confirmBox(e){return window.confirm(e)}render(){const{wait:e,fetchError:t}=this.state;let i=this.state.stack,r=i.length-1,s=null,o=null;switch(e){case 1:s=n.createElement("li",{className:"va-wait va-wait1"});break;case 2:s=n.createElement("li",{className:"va-wait va-wait2"},n.createElement("i",{className:"fa fa-spinner fa-spin fa-3x fa-fw"}),n.createElement("span",{className:"sr-only"},"Loading..."))}return t&&(o=n.createElement(a.a,Object.assign({clearError:this.clearError},t))),n.createElement("ul",{className:"va"},i.map((e,t)=>{let{key:i,view:s}=e;return n.createElement("li",{key:i,style:t<r?{visibility:"hidden"}:void 0},s)}),s,o)}refresh(){this.setState({stack:this.stack})}}function E(e){return void 0===e?{url:void 0,ws:void 0}:{url:"http://"+e+"/",ws:"ws://"+e+"/tv/"}}class k{constructor(){this.local=new c.a,this.user=void 0;let{lang:e,district:t}=h.b;this.language=e,this.culture=t}get guest(){let e=this.local.guest;if(void 0===e)return 0;let t=e.get();return void 0===t?0:t.guest}set(e){this.nav=e}registerReceiveHandler(e){if(void 0!==this.ws)return this.ws.onWsReceiveAny(e)}unregisterReceiveHandler(e){void 0!==this.ws&&void 0!==e&&this.ws.endWsReceive(e)}onReceive(e){return v(this,void 0,void 0,function*(){void 0!==this.ws&&(yield this.ws.receive(e))})}start(){return v(this,void 0,void 0,function*(){C.push(n.createElement(s.a,{header:!1},n.createElement(f.a,null)));let{url:e,ws:t}=yield function(){return v(this,void 0,void 0,function*(){let e=E("101.200.46.56"),t=E(Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_CENTER_HOST:"101.200.46.56"}).REACT_APP_CENTER_DEBUG_HOST||u.e);return!0===document.location.hash.includes("sheet_debug")?t:e})}();Object(u.n)(e),this.wsHost=t;let i=this.local.guest.get();void 0===i&&(i=yield u.g.guest()),C.setGuest(i);let r=document.location.hash;if(console.log("url=%s hash=%s",document.location.origin,r),this.isInFrame=void 0!==r&&""!==r&&r.startsWith("#tv"),!0===this.isInFrame){let e=Object(l.h)(r);if(void 0!==e)return this.ws=d.d,console.log("this.ws = wsBridge in sub frame"),void(self!==window.parent&&window.parent.postMessage({type:"sub-frame-started",hash:e.hash},"*"))}let o=this.local.user.get();if(void 0!==o)yield C.logined(o);else{let{notLogined:e}=this.nav.props;void 0!==e?yield e():yield C.showLogin()}})}showAppView(){return v(this,void 0,void 0,function*(){let{onLogined:e}=this.nav.props;void 0!==e?(C.clear(),yield e(),console.log("logined: AppView shown")):C.push(n.createElement("div",null,"NavView has no prop onLogined"))})}setGuest(e){this.local.guest.set(e),o.a.set(e.token)}logined(e){return v(this,void 0,void 0,function*(){(this.ws=new u.d(this.wsHost,e.token)).connect(),console.log("logined: %s",JSON.stringify(e)),this.local.user.set(e),o.a.set(e.token),this.user=e,console.log("ws.connect() in app main frame"),yield this.showAppView()})}showLogin(e){return v(this,void 0,void 0,function*(){let t=yield i.e(3).then(i.bind(null,73)),r=n.createElement(t.default,{withBack:e});!0!==e&&(this.nav.clear(),this.pop()),this.nav.push(r)})}logout(e){return v(this,void 0,void 0,function*(){this.local.logoutClear(),this.user=void 0,Object(u.i)(),Object(l.f)();let t=this.local.guest.get();Object(u.m)(t&&t.token),this.ws=void 0,!0!==e&&(yield this.showLogin())})}get level(){return this.nav.level}startWait(){this.nav.startWait()}endWait(){this.nav.endWait()}onError(e){return v(this,void 0,void 0,function*(){yield this.nav.onError(e)})}show(e,t){this.nav.show(e,t)}push(e,t){this.nav.push(e,t)}replace(e,t){this.nav.replace(e,t)}pop(e=1){this.nav.pop(e)}clear(){this.nav.clear()}navBack(){this.nav.navBack()}ceaseTop(e){this.nav.ceaseTop(e)}removeCeased(){this.nav.removeCeased()}back(e=!0){return v(this,void 0,void 0,function*(){yield this.nav.back(e)})}regConfirmClose(e){this.nav.regConfirmClose(e)}confirmBox(e){return this.nav.confirmBox(e)}navToApp(e,t,i,r,s){let o=!0===Object(u.f)().includes("http://localhost:")?"sheet_debug":"sheet",a=void 0===s?Object(l.a)(e,t):Object(l.a)(e,t,o,[i,r,s]);console.log("navToApp: %s",JSON.stringify(a)),C.push(n.createElement("article",{className:"app-container"},n.createElement("span",{id:a.hash,onClick:()=>this.back(),style:m},n.createElement("i",{className:"fa fa-arrow-left"})),n.createElement("iframe",{src:a.url})))}navToSite(e){window.open(e)}get logs(){return y}log(e){y.push(e)}logMark(){let e=new Date;g=e.getTime(),y.push("log-mark: "+e.toTimeString())}logStep(e){y.push(e+": "+((new Date).getTime()-g))}}p([r.k],k.prototype,"user",void 0);const C=new k}).call(this,i(24))},function(e,t,i){"use strict";i(32),i(22);var n=i(10);i.d(t,"CenterApi",function(){return n.a}),i.d(t,"UnitxApi",function(){return n.b}),i.d(t,"UsqApi",function(){return n.c}),i.d(t,"loadAppUsqs",function(){return n.h}),i.d(t,"meInFrame",function(){return n.j}),i.d(t,"postWsToTop",function(){return n.k});var r=i(14);i.o(r,"Controller")&&i.d(t,"Controller",function(){return r.Controller}),i.o(r,"Field")&&i.d(t,"Field",function(){return r.Field}),i.o(r,"Form")&&i.d(t,"Form",function(){return r.Form}),i.o(r,"Loading")&&i.d(t,"Loading",function(){return r.Loading}),i.o(r,"NavView")&&i.d(t,"NavView",function(){return r.NavView}),i.o(r,"Page")&&i.d(t,"Page",function(){return r.Page}),i.o(r,"TabCaptionComponent")&&i.d(t,"TabCaptionComponent",function(){return r.TabCaptionComponent}),i.o(r,"Tabs")&&i.d(t,"Tabs",function(){return r.Tabs}),i.o(r,"VPage")&&i.d(t,"VPage",function(){return r.VPage}),i.o(r,"View")&&i.d(t,"View",function(){return r.View}),i.o(r,"nav")&&i.d(t,"nav",function(){return r.nav}),i.o(r,"resLang")&&i.d(t,"resLang",function(){return r.resLang}),i.o(r,"uid")&&i.d(t,"uid",function(){return r.uid});var s=i(16);i.d(t,"uid",function(){return s.a});var o=i(41);i.d(t,"PageItems",function(){return o.a});i(42)},function(e,t,i){"use strict";i.d(t,"c",function(){return l}),i.d(t,"b",function(){return c}),i.d(t,"a",function(){return u});var n=i(0),r=i(1),s=i(9),o=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class a{constructor(e,t,i,r){if(this.widgets={},this.errors=[],this.errorWidgets=[],this.renderErrors=Object(s.a)(()=>{let{errors:e}=this;return 0===e.length?null:n.createElement(n.Fragment,null,e.map(e=>n.createElement("span",{key:e,className:"text-danger inline-block my-1 ml-3"},n.createElement("i",{className:"fa fa-exclamation-circle"})," \xa0",e)))}),this.form=e,this.uiSchema=t,this.data=i,this.inNode=r,void 0!==t){let{rules:e}=t;void 0!==e&&(this.rules=[],!1===Array.isArray(e)?this.rules.push(e):this.rules.push(...e))}}get arrName(){}getValue(e){return this.data[e]}setValue(e,t){this.data[e]=t;let i=this.widgets[e];void 0!==i&&i.setValue(t)}getDisabled(e){let t=this.widgets[e];if(void 0!==t)return t.getDisabled()}setDisabled(e,t){let i=this.widgets[e];void 0!==i&&i.setDisabled(t)}getReadOnly(e){let t=this.widgets[e];void 0!==t&&t.getReadOnly()}setReadOnly(e,t){let i=this.widgets[e];void 0!==i&&i.setReadOnly(t)}getVisible(e){let t=this.widgets[e];void 0!==t&&t.getVisible()}setVisible(e,t){let i=this.widgets[e];void 0!==i&&i.setVisible(t)}checkFieldRules(){for(let e in this.widgets)this.widgets[e].checkRules()}checkContextRules(){if(void 0!==this.rules){this.clearContextErrors();for(let e of this.rules){let t=e(this);if(void 0!==t)if(!0===Array.isArray(t))this.errors.push(...t);else if("string"===typeof t)this.errors.push(t);else for(let e in t)this.setError(e,t[e])}}}setError(e,t){let i=this.widgets[e];void 0!==i&&(i.setContextError(t),this.addErrorWidget(i))}clearContextErrors(){for(let e in this.widgets)this.widgets[e].clearContextError()}checkRules(){this.checkFieldRules(),this.checkContextRules()}addErrorWidget(e){this.errorWidgets.findIndex(t=>t===e)<0&&this.errorWidgets.push(e)}removeErrorWidget(e){let t=this.errorWidgets.findIndex(t=>t===e);t>=0&&this.errorWidgets.splice(t,1)}checkHasError(){return this.errorWidgets.length+this.errors.length>0}get hasError(){return this.checkHasError()}removeErrors(){this.errors.splice(0),this.errorWidgets.splice(0);for(let e in this.widgets){let t=this.widgets[e];void 0!==t&&t.clearContextError()}}}o([r.k],a.prototype,"errors",void 0),o([r.k],a.prototype,"errorWidgets",void 0),o([r.d],a.prototype,"hasError",null);class l extends a{constructor(e,t,i,n,r){let s,{form:o}=e,{uiSchema:a}=o;if(void 0!==a){let{items:e}=a;void 0!==e&&(s=e[t.name])}super(e.form,s,i,n),this.formContext=e,this.arrSchema=t,this.row=r}get isRow(){return!0}getItemSchema(e){return this.arrSchema.itemSchemas[e]}getUiItem(e){if(void 0===this.uiSchema)return;let{items:t}=this.uiSchema;return void 0!==t?t[e]:void 0}get arrName(){return this.arrSchema.name}}class c extends a{constructor(e,t){super(e,e.uiSchema,e.data,t),this.rowContexts={}}get isRow(){return!1}getItemSchema(e){return this.form.itemSchemas[e]}getUiItem(e){let{uiSchema:t}=this.form;if(void 0===t)return;let{items:i}=t;return void 0!==i?i[e]:void 0}checkFieldRules(){super.checkFieldRules();for(let e in this.rowContexts){let t=this.rowContexts[e];for(let e in t)t[e].checkFieldRules()}}checkContextRules(){super.checkContextRules();for(let e in this.rowContexts){let t=this.rowContexts[e];for(let e in t){let i=t[e];i.removeErrors(),i.checkContextRules()}}}get hasError(){if(!0===super.checkHasError())return!0;for(let e in this.rowContexts){let t=this.rowContexts[e];for(let e in t)if(!0===t[e].hasError)return!0}return!1}}o([r.d],c.prototype,"hasError",null);const u=n.createContext({})},function(e,t,i){"use strict";i.d(t,"f",function(){return h}),i.d(t,"g",function(){return p}),i.d(t,"d",function(){return v}),i.d(t,"h",function(){return m}),i.d(t,"a",function(){return g}),i.d(t,"e",function(){return y}),i.d(t,"b",function(){return b}),i.d(t,"c",function(){return E});var n=i(7),r=i.n(n),s=i(14),o=i(16),a=i(8),l=i(11),c=i(12),u=function(e,t,i,n){return new(i||(i=Promise))(function(r,s){function o(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(o,a)}l((n=n.apply(e,t||[])).next())})};const d={};function h(){for(let e in d)d[e]=void 0}const f={};let p=new class{get unit(){return this._unit}set unit(e){this._unit=e}};function v(){return self!==window.parent}function m(e){let t=e.split("-"),i=t.length;return p.hash=t[0].substr(3),i>0&&(p.unit=Number(t[1])),i>1&&(p.page=t[2]),i>2&&(p.param=t.slice(3)),p}function g(e,t,i,n){let r;for(;;){if(r=Object(o.a)(),void 0===f[r]){f[r]={hash:r,unit:t};break}}if(e+="#tv"+r+"-"+t,void 0!==i&&(e+="-"+i,void 0!==n))for(let s=0;s<n.length;s++)e+="-"+n[s];return{url:e,hash:r}}function y(e,t){return u(this,void 0,void 0,function*(){let i=new a.b("tv/",void 0),n=p.unit;return yield i.usqs(n,e,t)})}function b(e,t,i){return u(this,void 0,void 0,function*(){let n=d[e];if(void 0!==n)return n;if(!v()){if(void 0===(n=yield a.k.usq({unit:p.unit,usqOwner:t,usqName:i}))){throw"unauthorized call: usqTokenApi center return undefined!"}void 0===n.token&&(n.token=a.f);let{url:r,urlDebug:s}=n,o=yield Object(c.b)(r,s);return console.log("realUrl: %s",o),n.url=o,d[e]=n,n}return console.log("appApi parent send: %s",p.hash),n={name:e,url:void 0,urlDebug:void 0,token:void 0,resolve:void 0,reject:void 0},d[e]=n,new Promise((t,i)=>{n.resolve=(e=>u(this,void 0,void 0,function*(){let i=yield e;console.log("return from parent window: %s",JSON.stringify(i)),n.url=i.url,n.urlDebug=i.urlDebug,n.token=i.token,t(n)})),n.reject=i,(window.opener||window.parent).postMessage({type:"app-api",apiName:e,hash:p.hash},"*")})})}window.addEventListener("message",function(e){return u(this,void 0,void 0,function*(){var t=e.data;switch(t.type){case"sub-frame-started":!function(e){var t=e.data;let i=e.source;Object(l.c)(i),function(e){let t=document.getElementById(e);void 0!==t&&(t.hidden=!0)}(t.hash);let n=r.a.clone(s.nav.user);n.type="init-sub-win",i.postMessage(n,"*")}(e);break;case"ws":yield s.nav.onReceive(t.msg);break;case"init-sub-win":yield function(e){return u(this,void 0,void 0,function*(){console.log("initSubWin: set nav.user",e),s.nav.user=e,yield s.nav.showAppView()})}(t);break;case"pop-app":s.nav.navBack();break;case"center-api":yield function(e,t){return u(this,void 0,void 0,function*(){let{callId:i,url:n,method:r,body:s}=t,o=yield a.e.directCall(n,r,s);e.postMessage({type:"center-api-return",callId:i,result:o},"*")})}(e.source,t);break;case"center-api-return":!function(e){let{callId:t,result:i}=e,n=w[t];if(void 0===n)return;w[t]=void 0,n.resolve(i)}(t);break;case"app-api":console.log("receive PostMessage: %s",JSON.stringify(t));let i=yield function(e,t){return u(this,void 0,void 0,function*(){let i=f[e];if(void 0===i)return{name:t,url:void 0,urlDebug:void 0,token:void 0};let{unit:n}=i,r=t.split("/"),s=yield a.k.usq({unit:n,usqOwner:r[0],usqName:r[1]});if(void 0===s)throw console.log("apiTokenApi.api return undefined. api=%s, unit=%s",t,n),"api not found";return{name:t,url:s.url,urlDebug:s.urlDebug,token:s.token}})}(t.hash,t.apiName);console.log("onReceiveAppApiMessage: %s",JSON.stringify(i)),e.source.postMessage({type:"app-api-return",apiName:t.apiName,url:i.url,urlDebug:i.urlDebug,token:i.token},"*");break;case"app-api-return":console.log("app-api-return: %s",JSON.stringify(t)),console.log("await onAppApiReturn(message);"),yield function(e){return u(this,void 0,void 0,function*(){let{apiName:t,url:i,urlDebug:n,token:r}=e,s=d[t];if(void 0===s)throw"error app api return";let o=yield Object(c.b)(i,n);console.log("onAppApiReturn(message:any): url="+i+", debug="+n+", real="+o),s.url=o,s.token=r,s.resolve(s)})}(t);break;default:this.console.log("message: %s",JSON.stringify(t))}})});const w={};function E(e,t,i){return u(this,void 0,void 0,function*(){return console.log("bridgeCenterApi: url=%s, method=%s",e,t),yield new Promise((n,r)=>u(this,void 0,void 0,function*(){let s;for(;;){if(s=Object(o.a)(),void 0===w[s]){w[s]={id:s,resolve:n,reject:r};break}}(window.opener||window.parent).postMessage({type:"center-api",callId:s,url:e,method:t,body:i},"*")}))})}},,function(e,t,i){"use strict";var n=i(7),r=i(18),s=i(3),o=function(e,t,i,n){return new(i||(i=Promise))(function(r,s){function o(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(o,a)}l((n=n.apply(e,t||[])).next())})};class a{startWait(){s.c.startWait()}endWait(){s.c.endWait()}showError(e){return o(this,void 0,void 0,function*(){s.c.endWait(),yield s.c.onError(e)})}}var l=i(6),c=i(12);i.d(t,"h",function(){return f}),i.d(t,"d",function(){return p}),i.d(t,"c",function(){return g}),i.d(t,"j",function(){return y}),i.d(t,"g",function(){return b}),i.d(t,"f",function(){return k}),i.d(t,"i",function(){return C}),i.d(t,"a",function(){return x}),i.d(t,"k",function(){return T}),i.d(t,"e",function(){return S}),i.d(t,"b",function(){return O});var u=function(e,t,i,n){return new(i||(i=Promise))(function(r,s){function o(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(o,a)}l((n=n.apply(e,t||[])).next())})};let d={},h={};function f(){d={},h={},m={}}class p extends c.a{constructor(e,t,i,n,r){super(e,r),i&&(this.usqOwner=t,this.usqName=i,this.usq=t+"/"+i),this.access=n,this.showWaiting=r}getHttpChannel(){return u(this,void 0,void 0,function*(){let e,t;!0===this.showWaiting||void 0===this.showWaiting?(e=d,t=new a):e=h;let i=e[this.usq];if(void 0!==i)return i;let n=yield Object(l.b)(this.usq,this.usqOwner,this.usqName);return this.token=n.token,i=new r.a(!1,n.url,n.token,t),e[this.usq]=i})}update(){return u(this,void 0,void 0,function*(){return yield this.get("update")})}loadAccess(){return u(this,void 0,void 0,function*(){let e=void 0===this.access?"":this.access.join("|");return yield this.get("access",{acc:e})})}loadEntities(){return u(this,void 0,void 0,function*(){return yield this.get("entities")})}schema(e){return u(this,void 0,void 0,function*(){return yield this.get("schema/"+e)})}schemas(e){return u(this,void 0,void 0,function*(){return yield this.post("schema",e)})}tuidGet(e,t){return u(this,void 0,void 0,function*(){return yield this.get("tuid/"+e+"/"+t)})}tuidGetAll(e){return u(this,void 0,void 0,function*(){return yield this.get("tuid-all/"+e+"/")})}tuidSave(e,t){return u(this,void 0,void 0,function*(){return yield this.post("tuid/"+e,t)})}tuidSearch(e,t,i,n,r,s){return u(this,void 0,void 0,function*(){return yield this.post("tuids/"+e,{arr:t,owner:i,key:n,pageStart:r,pageSize:s})})}tuidArrGet(e,t,i,n){return u(this,void 0,void 0,function*(){return yield this.get("tuid-arr/"+e+"/"+i+"/"+t+"/"+n)})}tuidArrGetAll(e,t,i){return u(this,void 0,void 0,function*(){return yield this.get("tuid-arr-all/"+e+"/"+i+"/"+t+"/")})}tuidArrSave(e,t,i,n){return u(this,void 0,void 0,function*(){return yield this.post("tuid-arr/"+e+"/"+i+"/"+t+"/",n)})}tuidArrPos(e,t,i,n,r){return u(this,void 0,void 0,function*(){return yield this.post("tuid-arr-pos/"+e+"/"+i+"/"+t+"/",{id:n,$order:r})})}tuidIds(e,t,i){return u(this,void 0,void 0,function*(){try{let r="tuidids/"+e+"/";return r+=void 0!==t?t:"$",yield this.post(r,i)}catch(n){console.error(n)}})}proxied(e,t,i){return u(this,void 0,void 0,function*(){try{let r="tuid-proxy/"+e+"/"+t+"/"+i;return yield this.get(r)}catch(n){console.error(n)}})}sheetSave(e,t){return u(this,void 0,void 0,function*(){return yield this.post("sheet/"+e,t)})}sheetAction(e,t){return u(this,void 0,void 0,function*(){return yield this.put("sheet/"+e,t)})}stateSheets(e,t){return u(this,void 0,void 0,function*(){return yield this.post("sheet/"+e+"/states",t)})}stateSheetCount(e){return u(this,void 0,void 0,function*(){return yield this.get("sheet/"+e+"/statecount")})}getSheet(e,t){return u(this,void 0,void 0,function*(){return yield this.get("sheet/"+e+"/get/"+t)})}sheetArchives(e,t){return u(this,void 0,void 0,function*(){return yield this.post("sheet/"+e+"/archives",t)})}sheetArchive(e,t){return u(this,void 0,void 0,function*(){return yield this.get("sheet/"+e+"/archive/"+t)})}action(e,t){return u(this,void 0,void 0,function*(){return yield this.post("action/"+e,t)})}page(e,t,i,r){return u(this,void 0,void 0,function*(){let s;switch(typeof r){case"undefined":s={key:""};break;default:s=n.clone(r)}return s.$pageStart=t,s.$pageSize=i,yield this.post("query-page/"+e,s)})}query(e,t){return u(this,void 0,void 0,function*(){return yield this.post("query/"+e,t)})}user(){return u(this,void 0,void 0,function*(){return yield this.get("user")})}}let v,m={};class g extends p{constructor(e){super("tv/",void 0,void 0,void 0,!0),this.unitId=e}getHttpChannel(){return u(this,void 0,void 0,function*(){let e=m[this.unitId];return void 0!==e?e:m[this.unitId]=yield this.buildChannel()})}buildChannel(){return u(this,void 0,void 0,function*(){let e=new a,t=new O("tv/",void 0),i=yield t.unitxUsq(this.unitId),{token:n,url:s,urlDebug:o}=i,l=yield Object(c.b)(s,o);return this.token=n,new r.a(!1,l,n,e)})}}function y(e){console.log("setCenterUrl %s",e),v=e,k=void 0,E=void 0,w=void 0}function b(){return v}let w,E,k=void 0;function C(e){k=e,console.log("setCenterToken %s",e),E=void 0,w=void 0}class x extends c.a{constructor(e,t){super(e,t)}getHttpChannel(){return u(this,void 0,void 0,function*(){return!0===this.showWaiting||void 0===this.showWaiting?void 0!==w?w:w=new r.a(!0,v,k,new a):void 0!==E?E:E=new r.a(!0,v,k)})}}const T=new class extends x{usq(e){return u(this,void 0,void 0,function*(){return yield this.get("app-usq",e)})}}("tv/tie/",void 0);const S=new class extends x{directCall(e,t,i){return this.call(e,t,i)}}("",void 0);console.log("CenterApi"),console.log(x);class O extends x{usqs(e,t,i){return u(this,void 0,void 0,function*(){return yield this.get("tie/app-usqs",{unit:e,appOwner:t,appName:i})})}unitxUsq(e){return u(this,void 0,void 0,function*(){return yield this.get("tie/unitx-usq",{unit:e})})}}},,function(e,t,i){"use strict";var n=i(11),r=i(12),s=i(22),o=i(8),a=function(e,t,i,n){return new(i||(i=Promise))(function(r,s){function o(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(o,a)}l((n=n.apply(e,t||[])).next())})};const l=new class extends o.a{guest(){return a(this,void 0,void 0,function*(){let e=yield this.get("",{});switch(typeof e){default:return;case"string":return Object(s.a)(e);case"object":return Object(s.a)(e.token)}})}}("tv/guest/",void 0);var c=i(6),u=i(17);i(18);i.d(t,"d",function(){return n.a}),i.d(t,"k",function(){return n.b}),i.d(t,"l",function(){return r.c}),i.d(t,"g",function(){return l}),i.d(t,"i",function(){return o.h}),i.d(t,"c",function(){return o.d}),i.d(t,"b",function(){return o.c}),i.d(t,"n",function(){return o.j}),i.d(t,"f",function(){return o.g}),i.d(t,"m",function(){return o.i}),i.d(t,"a",function(){return o.a}),i.d(t,"j",function(){return c.g}),i.d(t,"h",function(){return c.e}),i.d(t,"e",function(){return u.a})},function(e,t,i){"use strict";i.d(t,"c",function(){return s}),i.d(t,"b",function(){return o}),i.d(t,"d",function(){return c}),i.d(t,"a",function(){return u});var n=function(e,t,i,n){return new(i||(i=Promise))(function(r,s){function o(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(o,a)}l((n=n.apply(e,t||[])).next())})};let r;function s(e){r=e}function o(e){window.top.postMessage({type:"ws",msg:e},"*")}class a{constructor(){this.handlerSeed=1,this.anyHandlers={},this.msgHandlers={}}onWsReceiveAny(e){let t=this.handlerSeed++;return this.anyHandlers[t]=e,t}onWsReceive(e,t){let i=this.handlerSeed++;return this.msgHandlers[i]={type:e,handler:t},i}endWsReceive(e){delete this.anyHandlers[e],delete this.msgHandlers[e]}receive(e){return n(this,void 0,void 0,function*(){let{$type:t}=e;for(let i in this.anyHandlers)yield this.anyHandlers[i](e);for(let i in this.msgHandlers){let{type:n,handler:r}=this.msgHandlers[i];n===t&&(yield r(e))}})}}let l=1;const c=new class extends a{constructor(){super(...arguments),this.wsBaseId="WsBridge seed "+l++}};class u extends a{constructor(e,t){super(),this.wsBaseId="WSChannel seed "+l++,this.wsHost=e,this.token=t}static setCenterToken(e){u.centerToken=e}connect(){if(void 0!==this.ws)return;let e=this;return new Promise((t,i)=>{let r=new WebSocket(this.wsHost,this.token||u.centerToken);console.log("connect webSocket %s",this.wsHost),r.onopen=(i=>{console.log("webSocket connected %s",this.wsHost),e.ws=r,t()}),r.onerror=(e=>{i("webSocket can't open!")}),r.onmessage=(t=>n(this,void 0,void 0,function*(){return yield e.wsMessage(t)})),r.onclose=(t=>{e.ws=void 0,console.log("webSocket closed!")})})}close(){void 0!==this.ws&&(this.ws.close(),this.ws=void 0)}wsMessage(e){return n(this,void 0,void 0,function*(){try{console.log("websocket message: %s",e.data);let i=JSON.parse(e.data);!function(e){void 0!==r&&r.postMessage({type:"ws",msg:e},"*")}(i),yield this.receive(i)}catch(t){console.log("ws msg error: ",t)}})}sendWs(e){let t=this;this.connect().then(()=>{t.ws.send(e)})}}},function(e,t,i){"use strict";i.d(t,"c",function(){return a}),i.d(t,"a",function(){return l}),i.d(t,"b",function(){return u});var n=i(13),r=i(17),s=i(27),o=function(e,t,i,n){return new(i||(i=Promise))(function(r,s){function o(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(o,a)}l((n=n.apply(e,t||[])).next())})};function a(e,t,i,n,r){return o(this,void 0,void 0,function*(){yield e.fetch(t,i,n,r)})}class l{constructor(e,t){this.path=e||"",this.showWaiting=t}call(e,t,i){return o(this,void 0,void 0,function*(){let n=yield this.getHttpChannel();return yield n.callFetch(e,t,i)})}get(e,t){return o(this,void 0,void 0,function*(){let i=yield this.getHttpChannel();return yield i.get(this.path+e,t)})}post(e,t){return o(this,void 0,void 0,function*(){let i=yield this.getHttpChannel();return yield i.post(this.path+e,t)})}put(e,t){return o(this,void 0,void 0,function*(){let i=yield this.getHttpChannel();return yield i.put(this.path+e,t)})}delete(e,t){return o(this,void 0,void 0,function*(){let i=yield this.getHttpChannel();return yield i.delete(this.path+e,t)})}}function c(e,t,i,n){if(e.indexOf(t)>0){let r=Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_CENTER_HOST:"101.200.46.56"})[n]||i;e=e.replace(t,"://"+r+"/")}return e}function u(e,t,i="hello"){return o(this,void 0,void 0,function*(){if(!0!==n.b)return e;if(!t)return e;try{let n=t;!1===t.endsWith("/")&&(t+="/"),t=c(t,"://centerhost/",r.a,"REACT_APP_CENTER_DEBUG_HOST"),t=c(t,"://usqhost/",r.c,"REACT_APP_USQ_DEBUG_HOST"),t=c(t,"://unitxhost/",r.c,"REACT_APP_USQ_DEBUG_HOST"),t=c(t,"://usql-server/",r.b,"REACT_APP_DEBUG_USQL_SERVER"),void 0===i&&(i="");let a=t+i;console.log("urlDebug: "+n+" ---- "+t+" === "+a);let l={method:"GET",mode:"no-cors",headers:{"Content-Type":"text/plain"}},u=yield Object(s.a)(a,l);yield u.text();return t}catch(o){return console.log("cannot connect %s, so use %s",t,e),console.error(o),e}})}},function(e,t,i){"use strict";i.d(t,"b",function(){return n}),i.d(t,"a",function(){return s});const n=!1;class r{constructor(e){this.name=e}get(){if(void 0!==this.value)return this.value;let e=localStorage.getItem(this.name);return this.value=null===e?void 0:JSON.parse(e)}set(e){e?(this.value=e,localStorage.setItem(this.name,JSON.stringify(e))):this.clear()}clear(){this.value=void 0,localStorage.removeItem(this.name)}}class s{constructor(){this.user=new r("user"),this.guest=new r("guest"),this.homeTabCur=new r("homeTabCur")}logoutClear(){[this.user,this.homeTabCur].map(e=>e.clear())}}},function(e,t,i){"use strict";var n=i(3);i.d(t,"NavView",function(){return n.a}),i.d(t,"nav",function(){return n.c});i(23);var r=i(20);i.d(t,"Page",function(){return r.a});i(34),i(35);var s=i(36);i.d(t,"Controller",function(){return s.a}),i.d(t,"VPage",function(){return s.b}),i.d(t,"View",function(){return s.c});var o=i(37);i.o(o,"Field")&&i.d(t,"Field",function(){return o.Field}),i.o(o,"Form")&&i.d(t,"Form",function(){return o.Form}),i.o(o,"Loading")&&i.d(t,"Loading",function(){return o.Loading}),i.o(o,"TabCaptionComponent")&&i.d(t,"TabCaptionComponent",function(){return o.TabCaptionComponent}),i.o(o,"Tabs")&&i.d(t,"Tabs",function(){return o.Tabs}),i.o(o,"resLang")&&i.d(t,"resLang",function(){return o.resLang}),i.o(o,"uid")&&i.d(t,"uid",function(){return o.uid});var a=i(21);i.d(t,"resLang",function(){return a.a});var l=i(44);i.d(t,"TabCaptionComponent",function(){return l.a}),i.d(t,"Tabs",function(){return l.b});var c=i(25);i.d(t,"Loading",function(){return c.a})},,function(e,t,i){"use strict";i.d(t,"a",function(){return s});const n="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",r=8;function s(){let e=n.length,t="";for(let i=0;i<r;i++)t+=n.charAt(Math.floor(Math.random()*e));return t}},function(e,t,i){"use strict";i.d(t,"a",function(){return n}),i.d(t,"c",function(){return r}),i.d(t,"b",function(){return s});const n="localhost:3000",r="localhost:3015",s="localhost:3009"},function(e,t,i){"use strict";i.d(t,"a",function(){return a});var n=i(6),r=i(3),s=i(13),o=function(e,t,i,n){return new(i||(i=Promise))(function(r,s){function o(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(o,a)}l((n=n.apply(e,t||[])).next())})};class a{constructor(e,t,i,n){this.startWait=(()=>{void 0!==this.ui&&this.ui.startWait()}),this.endWait=((e,t)=>{void 0!==this.ui&&this.ui.endWait(),void 0!==t&&t("\u8bbf\u95eewebapi\u8d85\u65f6 "+e)}),this.showError=(e=>o(this,void 0,void 0,function*(){void 0!==this.ui&&(yield this.ui.showError(e))})),this.isCenter=e,this.hostUrl=t,this.apiToken=i,this.ui=n,this.timeout=!0===s.b?5e5:5e3}used(){this.post("",{})}get(e,t){return o(this,void 0,void 0,function*(){if(t){let i=Object.keys(t);if(i.length>0){let n="?";for(let r of i){void 0!==t[r]&&(e+=n+r+"="+t[r],n="&")}}}let i=this.buildOptions();return i.method="GET",yield this.innerFetch(e,i)})}post(e,t){return o(this,void 0,void 0,function*(){let i=this.buildOptions();return i.method="POST",i.body=JSON.stringify(t),yield this.innerFetch(e,i)})}put(e,t){return o(this,void 0,void 0,function*(){let i=this.buildOptions();return i.method="PUT",i.body=JSON.stringify(t),yield this.innerFetch(e,i)})}delete(e,t){return o(this,void 0,void 0,function*(){let i=this.buildOptions();return i.method="DELETE",i.body=JSON.stringify(t),yield this.innerFetch(e,i)})}fetch(e,t,i,n){return o(this,void 0,void 0,function*(){let s=this;this.startWait();let a=e;function l(e){return{channel:s,url:a,options:t,resolve:i,reject:n,error:e}}try{console.log("%s %s",t.method,a);let u=setTimeout(()=>s.endWait(e,n),this.timeout),d=yield fetch(encodeURI(a),t);if(!1===d.ok)throw clearTimeout(u),s.endWait(),console.log("call error %s",d.statusText),d.statusText;let h=d.headers.get("content-type");if(h&&h.indexOf("json")>=0)return d.json().then(e=>o(this,void 0,void 0,function*(){if(clearTimeout(u),s.endWait(),!0===e.ok)return i(e.res);void 0===e.error?yield s.showError(l("not valid tonva json")):(yield s.showError(l(e.error)),n(e.error))})).catch(e=>o(this,void 0,void 0,function*(){yield s.showError(l(e.message))}));{let e=yield d.text();clearTimeout(u),s.endWait(),i(e)}}catch(c){if("string"===typeof c&&!0===c.toLowerCase().startsWith("unauthorized"))return void r.c.logout();yield this.showError(l(c.message))}})}innerFetch(e,t){return o(this,void 0,void 0,function*(){let i=this.hostUrl+e;return!0===this.isCenter&&void 0===this.apiToken&&Object(n.d)()?yield Object(n.c)(i,t.method,t.body):yield new Promise((e,n)=>o(this,void 0,void 0,function*(){yield this.fetch(i,t,e,n)}))})}callFetch(e,t,i){return o(this,void 0,void 0,function*(){let n=this.buildOptions();return n.method=t,n.body=i,yield new Promise((t,i)=>o(this,void 0,void 0,function*(){yield this.fetch(e,n,t,i)}))})}buildOptions(){let{language:e,culture:t}=r.c,i=new Headers;i.append("Content-Type","application/json;charset=UTF-8");let n=e;return t&&(n+="-"+t),i.append("Accept-Language",n),this.apiToken&&i.append("Authorization",this.apiToken),{headers:i}}}},,function(e,t,i){"use strict";i.d(t,"a",function(){return f});var n=i(0),r=i(9),s=i(2),o=i.n(s),a=i(7),l=i.n(a),c=i(23),u=function(e,t,i,n){return new(i||(i=Promise))(function(r,s){function o(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(o,a)}l((n=n.apply(e,t||[])).next())})};const d=100;class h extends n.Component{constructor(){super(...arguments),this.bottomTime=0,this.topTime=0,this.onScroll=(e=>u(this,void 0,void 0,function*(){let{onScroll:t,onScrollTop:i,onScrollBottom:n}=this.props;t&&this.props.onScroll(e);let r=e.target;if(r.scrollTop<30&&void 0!==i){let e=(new Date).getTime();e-this.topTime>d&&(this.topTime=e,i())}if(r.scrollTop+r.offsetHeight>r.scrollHeight-30&&void 0!==n){let e=(new Date).getTime();e-this.bottomTime>d&&(this.bottomTime=e,n())}}))}eachChild(e,t){let{props:i}=e;if(void 0===i)return;let{children:r}=i;void 0!==r&&n.Children.forEach(r,(e,i)=>{let{_$scroll:n}=e;n&&n(t),console.log(e.toString()),this.eachChild(e,t)})}render(){return n.createElement("main",{className:this.props.className,onScroll:this.onScroll},this.props.children)}}let f=class extends n.Component{constructor(e){super(e);let t,{tabs:i}=e;if(void 0===i||0===i.length)return;this.tabs=i;let n=[];for(let r of i){let e=l.a.clone(r);void 0===t&&!0===e.isSelected?t=e:e.isSelected=!1,e.isMounted=!1,n.push(e)}this.state={cur:t,tabs:n}}componentDidMount(){return u(this,void 0,void 0,function*(){if(void 0===this.tabs)return;let e=this.state.tabs[0];void 0!==e&&(yield this.onTabClick(e))})}onTabClick(e){return u(this,void 0,void 0,function*(){if(!0===e.isSelected)return;let t,i=this.state.tabs;for(let n of i)n===e?(n.isSelected=!0,t=n):n.isSelected=!1;if(!0!==t.isMounted){let{load:e}=t;void 0!==e&&(yield e())}this.setState({cur:t,tabs:i})})}onTouchStart(e){}renderTabs(e){const{header:t,back:i,right:r,keepHeader:s}=this.props;let a,l=this.state.cur,u=n.createElement("div",null,this.state.tabs.map((e,t)=>{const{icon:i,isSelected:r,title:s,redDot:a}=e;let l,c,u;if(void 0!==i&&(l=n.createElement("img",{src:i})),void 0!==a){let e=a.get();e<0?(u=o()("red-dot"),c=n.createElement("u",null)):e>0&&(u=o()("red-dot","num"),c=n.createElement("u",null,e))}return n.createElement("div",{key:t,className:o()("va-tab",{cur:r}),onClick:()=>this.onTabClick(e)},l,n.createElement("div",{className:u},s,c))}));return!1!==t&&(a=n.createElement(c.a,{back:i,center:!0===s?t:l&&(l.header||l.title),right:r})),n.createElement("article",{className:"page-container"},a,n.createElement("section",null,this.state.tabs.map((e,t)=>{let{isSelected:i,isMounted:r,content:s}=e;if(!0===i||!0===r)return e.isMounted=!0,n.createElement(h,{key:t,className:o()({invisible:!1===i}),onScroll:e.onScroll,onScrollTop:e.onScrollTop,onScrollBottom:e.onScrollBottom},"function"===typeof s?s():s)})),u,e)}renderSingle(e){const{back:t,header:i,right:r,onScroll:s,onScrollTop:o,onScrollBottom:a,children:l}=this.props;let u;return!1!==i&&(u=n.createElement(c.a,{back:t,center:i,right:r,logout:this.props.logout})),n.createElement("article",{className:"page-container",onTouchStart:this.onTouchStart},u,n.createElement("section",null,n.createElement(h,{onScroll:s,onScrollTop:o,onScrollBottom:a},l)),e)}render(){const{footer:e}=this.props;let t;return void 0!==e&&(t=n.createElement("footer",null,e)),void 0!==this.tabs?this.renderTabs(t):this.renderSingle(t)}};f=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o}([r.a],f)},function(e,t,i){"use strict";i.d(t,"b",function(){return s}),i.d(t,"a",function(){return o});var n=i(7),r=i.n(n);const s={lang:void 0,district:void 0};function o(e){let{lang:t,district:i}=s,n={};if(void 0===e)return n;r.a.merge(n,e._);let o=e[t];if(void 0===o)return n;r.a.merge(n,o._);let a=o[i];if(void 0===a)return n;r.a.merge(n,a);let{entity:l}=n;if(void 0!==l)for(let r in l)l[r.toLowerCase()]=l[r];return n}!function(){let e,t,i=navigator.languages&&navigator.languages[0]||navigator.language;if(i){let n=i.split("-");e=n[0],n.length>1&&(t=n[1])}else e="zh",t="CN";!function(e,t){s.lang=e,s.district=t}(e,t)}()},function(e,t,i){"use strict";i.d(t,"b",function(){return s}),i.d(t,"a",function(){return o});var n=i(29),r=i.n(n);function s(e){let t=r()(e);return{id:t.id,name:t.name,guest:t.guest,token:e}}function o(e){return{id:0,guest:r()(e).guest,token:e}}},function(e,t,i){"use strict";i.d(t,"a",function(){return o});var n=i(0),r=i(3),s=function(e,t,i,n){return new(i||(i=Promise))(function(r,s){function o(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(o,a)}l((n=n.apply(e,t||[])).next())})};class o extends n.Component{constructor(e){super(e),this.logoutClick=(()=>{if(!1===confirm("Really want to logout?"))return;let{logout:e}=this.props;"function"===typeof e&&e(),r.c.logout()}),this.navChange=this.navChange.bind(this),this.state={hasBack:!1}}navChange(){this.setState({hasBack:r.c.level>1})}componentWillMount(){this.navChange()}componentWillUnmount(){}back(){return s(this,void 0,void 0,function*(){yield r.c.back()})}openWindow(){window.open(document.location.href)}render(){let e,t,i,s,o=this.state.hasBack||self!=top,{right:a,center:l,logout:c}=this.props;if(void 0!==c&&self===top&&("boolean"===typeof c&&!0===c||"function"===typeof c)){let{nick:e,name:t}=r.c.user;i=n.createElement("div",{className:"d-flex align-items-center"},n.createElement("small",{className:"text-light"},e||t),n.createElement("a",{className:"dropdown-toggle btn btn-secondary btn-sm ml-2",role:"button",onClick:this.logoutClick},n.createElement("i",{className:"fa fa-sign-out"})))}if(o)switch(this.props.back){case"none":e=void 0;break;default:case"back":e=n.createElement("nav",{onClick:this.back},n.createElement("i",{className:"fa fa-arrow-left"}));break;case"close":e=n.createElement("nav",{onClick:this.back},n.createElement("i",{className:"fa fa-close"}))}return self!=top&&(console.log(document.location.href),t=n.createElement("header",{onClick:this.openWindow})),(a||i)&&(s=n.createElement("aside",null,a," ",i)),n.createElement("header",{style:r.b},t,e,n.createElement("div",null,l),s)}}},,function(e,t,i){"use strict";i.d(t,"a",function(){return r});var n=i(0);function r(){return n.createElement("div",{style:{height:"100%"},className:"d-flex flex-fill align-items-center justify-content-center"},n.createElement("div",{className:"d-flex align-items-center justify-content-center slide text-info",style:{width:"5em",height:"2em"}},"\u52a0\u8f7d\u4e2d..."))}},function(e,t,i){"use strict";var n=i(0),r=i(9),s=i(2),o=i.n(s),a=i(7),l=i.n(a);class c{}class u extends c{constructor(e){super(),this.func=e}check(e,t){let i=this.func(t);if(void 0!==i)switch(typeof i){case"undefined":return;case"string":return void e.push(i);default:return void e.push(...i)}}}class d extends c{constructor(e){super(),this.res=e}}class h extends d{check(e,t){switch(typeof t){default:case"boolean":return;case"object":if(null!==t)return;break;case"string":if(t.trim().length>0)return;break;case"number":if(NaN!==t)return;break;case"undefined":}e.push(this.res.required)}}class f extends d{constructor(e,t,i){super(e),this.minMsg=l.a.template(e.min),this.maxMsg=l.a.template(e.max),this.min=t,this.max=i}check(e,t){if(void 0===t||null===t)return;let i=Number(t);NaN===i?e.push(this.res.number):this.checkMore(e,i)}checkMore(e,t){void 0!==this.min&&Number(t)<this.min&&e.push(this.minMsg({min:this.min})),void 0!==this.max&&Number(t)>this.max&&e.push(this.maxMsg({max:this.max}))}}class p extends f{checkMore(e,t){super.checkMore(e,t),!1===Number.isInteger(t)&&e.push(this.res.integer)}}var v=i(1),m=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class g{constructor(e,t,i,n){this.errors=[],this.contextErrors=[],this.onChange=(e=>{let t,i,n=this.value;void 0!==this.ui&&(t=this.ui.onChanging,i=this.ui.onChanged);let r=!0;void 0!==t&&(this.isChanging=!0,r=t(this.context,this.value,n),this.isChanging=!1),!0===r&&(this.setDataValue(e.currentTarget.value),void 0!==i&&(this.isChanging=!0,i(this.context,this.value,n),this.isChanging=!1))}),this.context=e;let{name:r}=t;if(this.name=r,this.itemSchema=t,this.fieldProps=i,this.children=n,this.ui=e.getUiItem(r),void 0===this.ui)this.readOnly=!1,this.disabled=!1,this.visible=!0;else{let{readOnly:e,disabled:t,visible:i}=this.ui;this.readOnly=!0===e,this.disabled=!0===t,this.visible=!(!1===i)}this.value=this.defaultValue=e.getValue(r),this.init()}get hasError(){return this.errors.length+this.contextErrors.length>0}init(){if(this.rules=[],!0===this.itemSchema.required&&this.rules.push(new h(this.context.form.res)),this.buildRules(),void 0===this.ui)return;let{rules:e}=this.ui;if(void 0!==e)if(!1!==Array.isArray(e))for(let t of e)this.rules.push(new u(t));else this.rules.push(new u(e))}buildRules(){}checkRules(){let e=[];for(let t of this.rules)t.check(e,this.value);0===e.length?this.context.removeErrorWidget(this):(this.context.addErrorWidget(this),this.errors.push(...e))}get isOk(){return 0===this.errors.length}setError(e){void 0!==e&&("string"===typeof e?this.errors.push(e):this.errors.push(...e))}setContextError(e){void 0!==e&&("string"===typeof e?this.contextErrors.push(e):this.contextErrors.push(...e))}clearError(){this.errors.splice(0)}clearContextError(){this.contextErrors.splice(0)}parse(e){return e}setElementValue(e){}setDataValue(e){!0!==this.isChanging&&(this.context.data[this.name]=this.value=this.parse(e))}setValue(e){!0!==this.isChanging&&(this.setDataValue(e),this.setElementValue(e))}getValue(){return this.context.getValue(this.name)}getReadOnly(){return this.readOnly}getDisabled(){return this.disabled}getVisible(){return this.visible}setReadOnly(e){this.readOnly=e}setDisabled(e){this.disabled=e}setVisible(e){this.visible=e}get className(){let e;return!1===this.context.inNode&&(e="form-control"),o()(e,this.context.form.FieldClass,this.ui&&this.ui.className)}renderContainer(){if(!1===this.visible)return null;let e,{form:t,inNode:i}=this.context;if(!0===i)return this.render();if(void 0===this.ui)e=this.name;else{let t=this.ui.label;null===t&&(e=null),e=t||this.name}return!0===this.itemSchema.required&&!1!==t.props.requiredFlag&&null!==e&&(e=n.createElement(n.Fragment,null,e,"\xa0",n.createElement("span",{className:"text-danger"},"*"))),t.FieldContainer(e,this.render())}renderTemplet(){if(void 0!==this.children)return n.createElement(n.Fragment,null,this.children);if(void 0===this.ui)return;let{Templet:e}=this.ui;return"function"===typeof e?e(this.context,this.name,this.value):e}renderErrors(){let e=[...this.errors,...this.contextErrors];if(0===e.length)return null;let{inNode:t}=this.context,i=!0===t?"span":"div";return e.map(e=>n.createElement(i,{key:e,className:"text-danger d-inline-block my-2 ml-3"},n.createElement(n.Fragment,null,n.createElement("i",{className:"fa fa-exclamation-circle"})," \xa0",e)))}}m([v.k],g.prototype,"errors",void 0),m([v.k],g.prototype,"contextErrors",void 0),m([v.d],g.prototype,"hasError",null),m([v.k],g.prototype,"visible",void 0),m([v.d],g.prototype,"isOk",null);class y extends g{constructor(){super(...arguments),this.inputType="text",this.onBlur=(()=>{this.checkRules(),this.context.checkContextRules()}),this.onFocus=(()=>{this.clearError(),this.context.removeErrorWidget(this),this.context.removeErrors()})}setElementValue(e){this.input.value=e}get placeholder(){return this.ui&&this.ui.placeholder||this.name}setReadOnly(e){this.input.readOnly=this.readOnly=e}setDisabled(e){this.input.disabled=this.disabled=e}render(){let e=this.renderTemplet();if(void 0!==e)return e;let t={};return!0===this.hasError?t["is-invalid"]=!0:t["required-item"]=!0===this.itemSchema.required,n.createElement(n.Fragment,null,n.createElement("input",{ref:e=>this.input=e,className:o()(this.className,t),type:this.inputType,defaultValue:this.defaultValue,onChange:this.onChange,placeholder:this.placeholder,readOnly:this.readOnly,disabled:this.disabled,onKeyDown:this.onKeyDown,onFocus:this.onFocus,onBlur:this.onBlur,maxLength:this.itemSchema.maxLength}),this.renderErrors())}}class b extends y{constructor(){super(...arguments),this.inputType="number"}buildRules(){super.buildRules();let e=this.context.form.res,{min:t,max:i}=this.itemSchema;this.rules.push("integer"===this.itemSchema.type?new f(e,t,i):new p(e,t,i))}parse(e){if(void 0!==e&&null!==e)return Number(e)}}class w extends b{constructor(){super(...arguments),this.inputType="number",this.onKeyDown=(e=>{let t=e.keyCode;event.returnValue=46===t||8===t||37===t||39===t||t>=48&&t<=57||t>=96&&t<=105||109===t||189===t})}}class E extends y{constructor(){super(...arguments),this.inputType="date"}}class k extends g{constructor(){super(...arguments),this.onChange=(e=>{this.setDataValue(!0===e.target.checked?this.trueValue:this.falseValue)})}init(){if(super.init(),void 0!==this.ui){let{trueValue:e,falseValue:t}=this.ui;this.trueValue=void 0===e||e,this.falseValue=void 0!==t&&t}else this.trueValue=!0,this.falseValue=!1}setElementValue(e){this.input.checked=e===this.trueValue}setReadOnly(e){this.input.readOnly=this.readOnly=e}setDisabled(e){this.input.disabled=this.disabled=e}render(){let e=o()(this.className,"form-check-inline"),t=n.createElement("input",{ref:e=>this.input=e,className:"align-self-center",type:"checkbox",defaultChecked:this.defaultValue,onChange:this.onChange});return this.context.inNode?n.createElement("label",{className:e},t," ",this.ui&&this.ui.label||this.name):n.createElement("div",{className:e},t)}}let C=1;class x{constructor(e,t,i){this.key=C++,this.form=e,this.arrSchema=t;let{uiSchema:n}=e;void 0!==n&&(this.uiArr=n.items[t.name]),this.data=i}}var T=i(5);class S extends g{constructor(){super(...arguments),this.onChange=(e=>{this.setDataValue(e.target.value)})}setElementValue(e){this.select.value=e}setReadOnly(e){this.select.disabled=this.readOnly=!e}setDisabled(e){this.select.disabled=this.disabled=e}render(){if(!0===this.readOnly){let e=this.ui.list.find(e=>e.value===this.value),t=void 0===e?"(???)":e.title;return n.createElement("span",{className:"form-control w-min-6c"},t)}return n.createElement("select",{ref:e=>this.select=e,className:o()(this.className,"form-control"),defaultValue:this.defaultValue,onChange:this.onChange},this.ui.list.map((e,t)=>{let{title:i,value:r}=e;return n.createElement("option",{className:void 0,key:t,value:r},i||r)}))}}(function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);s>3&&o&&Object.defineProperty(t,i,o)})([v.k],S.prototype,"readOnly",void 0);var O=function(e,t,i,n){return new(i||(i=Promise))(function(r,s){function o(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(o,a)}l((n=n.apply(e,t||[])).next())})};class N extends g{constructor(){super(...arguments),this.onClick=(()=>O(this,void 0,void 0,function*(){let e=this.ui&&this.ui.pickId;if(void 0===e)return void alert("no pickId defined!");let t=yield e(this.context,this.name,this.value);this.setDataValue(t),this.clearError(),this.clearContextError(),this.checkRules()}))}setReadOnly(e){this.readOnly=e}setDisabled(e){this.disabled=e}render(){let e,t;void 0!==this.ui&&(e=this.ui.placeholder,t=this.ui.Templet);let i,r={"form-control":!0,"required-item":!0===this.itemSchema.required,"cursor-pointer":!0,"is-invalid":this.hasError};return void 0===this.value||null===this.value?(i=e||"placeholder",r["text-muted"]=!0):i=void 0===t?n.createElement(n.Fragment,null,this.value):"function"===typeof t?t(this.context,this.name,this.value):t,n.createElement(n.Fragment,null,n.createElement("div",{className:o()(r),onClick:this.onClick},i),this.renderErrors())}}(function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);s>3&&o&&Object.defineProperty(t,i,o)})([v.k],N.prototype,"value",void 0);const R=(e,t,i)=>n.createElement("span",{className:"text-danger"},"!!data type ",e," only support ",(i||[]).join(", "),", can't use ui ",t,"!!");var P=function(e,t,i,n){return new(i||(i=Promise))(function(r,s){function o(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(o,a)}l((n=n.apply(e,t||[])).next())})};class j extends g{constructor(){super(...arguments),this.onClick=(()=>P(this,void 0,void 0,function*(){this.clearError(),this.clearContextError();let{name:e,type:t}=this.itemSchema;if("submit"===t&&(this.context.checkRules(),!0===this.context.hasError))return;let{onButtonClick:i}=this.context.form.props;if(void 0===i)return void alert(`button ${e} clicked. you should define form onButtonClick`);let n=yield i(e,this.context);void 0!==n&&this.context.setError(e,n)})),this.observerRender=Object(r.a)(()=>{let e,t,i,{name:r,type:s}=this.itemSchema;if(void 0!==this.ui){let{widget:n}=this.ui;if("button"!==n)return R(s,n,["button"]);e=this.ui.Templet,t=this.ui.className,i=this.ui.label}let o,{form:a,hasError:l}=this.context,c=this.context,u="submit"===s&&l;o=void 0!==this.children?this.children:"function"===typeof e?e(c,r):void 0!==e?e:i;let d=n.createElement("button",{className:t,type:"button",disabled:u,onClick:this.onClick},o||r);return!0===c.inNode?n.createElement(n.Fragment,null,d,this.renderErrors()):n.createElement("div",{className:a.ButtonClass},n.createElement("div",null,this.renderErrors()),d)})}render(){return n.createElement(this.observerRender,null)}renderContainer(){if(!1===this.visible)return null;let{form:e,inNode:t}=this.context;return!0===t?this.render():e.FieldContainer(null,this.render())}}const D={id:{dataTypes:["id"],widget:N},text:{dataTypes:["integer","number","string"],widget:y},textarea:{dataTypes:["string"],widget:class extends g{constructor(){super(...arguments),this.onChange=(e=>{this.setValue(e.currentTarget.value)})}setElementValue(e){this.input.value=e}setReadOnly(e){this.input.readOnly=this.readOnly=e}setDisabled(e){this.input.disabled=this.disabled=e}render(){return n.createElement("textarea",{ref:e=>this.input=e,rows:this.ui&&this.ui.rows,maxLength:this.itemSchema.maxLength,defaultValue:this.defaultValue,onChange:this.onChange})}}},password:{dataTypes:["string"],widget:class extends y{constructor(){super(...arguments),this.inputType="password"}}},date:{dataTypes:["date"],widget:E},datetime:{dataTypes:["date"],widget:class extends y{constructor(){super(...arguments),this.inputType="datetime"}}},time:{dataTypes:["date"],widget:class extends y{constructor(){super(...arguments),this.inputType="time"}}},month:{dataTypes:["date"],widget:class extends y{constructor(){super(...arguments),this.inputType="month"}}},select:{dataTypes:["integer","number","string","date","boolean"],widget:S},url:{dataTypes:["string"],widget:class extends y{constructor(){super(...arguments),this.inputType="url"}}},email:{dataTypes:["string"],widget:class extends y{constructor(){super(...arguments),this.inputType="email"}}},number:{dataTypes:["integer","number"],widget:b},updown:{dataTypes:["integer","number"],widget:w},color:{},checkbox:{dataTypes:["boolean","integer","number"],widget:k},checkboxes:{},radio:{dataTypes:["integer","number","string","date","boolean"],widget:class extends g{constructor(){super(...arguments),this.inputs={}}setElementValue(e){for(let t in this.inputs){let i=this.inputs[t];i.checked=e===i.value}}setReadOnly(e){this.readOnly=e;for(let t in this.inputs)this.inputs[t].readOnly=e}setDisabled(e){this.disabled=e;for(let t in this.inputs)this.inputs[t].disabled=e}render(){let e,{defaultValue:t,list:i}=this.ui,{isRow:r,inNode:s}=this.context;!0===r&&(e=this.context.row.key);let a=o()(this.className,"form-radio-inline");return n.createElement("span",{className:a},i.map((i,r)=>{let{value:s,title:o}=i,a=this.name;return void 0!==e&&(a+="-"+e),n.createElement("label",{key:r,className:"form-radio-inline"},n.createElement("input",{ref:e=>this.inputs[r]=e,type:"radio",name:a,value:s,defaultChecked:(this.defaultValue||t)===s}),o||s)}))}}},range:{dataTypes:["integer"],widget:class extends g{constructor(){super(...arguments),this.inputType="range"}setReadOnly(e){this.input.readOnly=this.readOnly=e}setDisabled(e){this.input.disabled=this.disabled=e}render(){let{min:e,max:t,step:i}=this.ui;return n.createElement(n.Fragment,null,n.createElement("input",{ref:e=>this.input=e,className:o()(this.className,"form-control","w-min-6c"),type:this.inputType,defaultValue:this.defaultValue,onChange:this.onChange,max:t,min:e,step:i}))}}},button:{dataTypes:["button","submit"],widget:j}};function A(e,t,i,s){if(void 0===e)return null;if(void 0===t)return;let o,{name:a,type:l}=t;switch(l){case"arr":let t=e.getItemSchema(a);return n.createElement(V,{formContext:e,arrSchema:t,children:i})}let c=e.getUiItem(a);function u(e){switch(e){default:return y;case"id":return N;case"integer":return w;case"number":return b;case"string":return y;case"date":return E;case"boolean":return k;case"button":case"submit":return j}}if(void 0===c)o=u(l);else{let{widget:e}=c;switch(e){default:if(void 0!==e){o=D[e].widget}void 0===o&&(o=u(l));break;case"group":return n.createElement("span",null,"impletment group")}}let{isRow:d,widgets:h}=e,f=new o(e,t,s,i);if(h[a]=f,!1===d){let e=Object(r.a)(()=>f.renderContainer());return n.createElement(e,null)}return f.renderContainer()}const V=Object(r.a)(({formContext:e,arrSchema:t,children:i})=>{let{name:s,arr:a}=t,l=e.data[s],{form:c,rowContexts:u}=e,d=u[s];void 0===d&&(u[s]=d={});let h,f,p,v,m=e.getUiItem(s),g=s;if(void 0!==m){let{widget:e,label:i,selectable:n,deletable:r,restorable:s}=m;if(f=n,p=r,v=s,h=m.Templet,"arr"!==e)return R(t.type,e,["arr"]);g=i||g}let{ArrContainer:y,RowContainer:b,uiSchema:w}=c;if(void 0!==w){let{selectable:e,deletable:t,restorable:i}=w;!0!==f&&(f=e),!0!==p&&(p=t),!0!==v&&(v=i)}let E=!0;return y(g,n.createElement(n.Fragment,null,l.map((s,u)=>{let m=s.$row;void 0===m&&(s.$row=m=new x(c,t,s));let g,y,w=m.key;if(!0===f){let e=e=>{s.$isSelected=e.target.checked};g=n.createElement("div",{className:"form-row-checkbox"},n.createElement("input",{type:"checkbox",onClick:e}))}let k=!(void 0===s.$isDeleted||!1===s.$isDeleted);if(!0===p){let e=k?"fa-undo":"fa-trash",t=()=>{if(!0===v)s.$isDeleted=!k;else{let e=l.indexOf(s);e>=0&&l.splice(e,1)}};y=n.createElement("div",{className:"form-row-edit align-self-start text-info cursor-pointer",onClick:t},n.createElement("i",{className:o()("fa",e,"fa-fw")}))}let C,S,O=!0===f||!0===p?e=>n.createElement("fieldset",{disabled:k},n.createElement("div",{className:o()("d-flex",{deleted:k,"row-selected":s.$isSelected})},g,n.createElement("div",{className:"flex-grow-1"},e),y)):e=>e,N=void 0;if(!1===E?N=c.RowSeperator:E=!1,void 0!==i)C=new T.c(e,t,s,!0,m),S=n.createElement(n.Fragment,null,"children");else{let i=typeof h;"function"===i?(C=new T.c(e,t,s,!0,m),S=n.createElement(Object(r.a)(h))):"object"===i?(C=new T.c(e,t,s,!0,m),S=h):(C=new T.c(e,t,s,!1,m),S=n.createElement(n.Fragment,null,a.map((e,t)=>n.createElement(n.Fragment,{key:e.name},A(C,e,void 0)))))}return d[w]=C,n.createElement(T.a.Provider,{key:w,value:C},N,b(O(n.createElement(n.Fragment,null,n.createElement(C.renderErrors,null),S))))})))});i.d(t,"a",function(){return A})},function(e,t,i){"use strict";i.d(t,"a",function(){return r});const n=2e3;function r(e,t){return new Promise((i,r)=>{fetch(e,t).then(i).catch(r);const s=new Error("Connection timed out");setTimeout(r,n,s)})}},function(e,t,i){"use strict";i.d(t,"a",function(){return r});var n=i(1);const r={homeCount:n.k.box(-1),cartCount:n.k.box(101)}},,function(e,t,i){"use strict";i.d(t,"a",function(){return s});var n=i(8),r=i(11);const s={set(e){Object(n.i)(e),r.a.setCenterToken(e)},clear(){Object(n.i)(void 0),r.a.setCenterToken(void 0)}}},,function(e,t,i){"use strict"},,function(e,t,i){"use strict";i(0)},function(e,t,i){"use strict";i(0),i(2)},function(e,t,i){"use strict";i.d(t,"a",function(){return l}),i.d(t,"c",function(){return c}),i.d(t,"b",function(){return u});var n=i(0),r=i(13),s=i(3),o=i(20),a=function(e,t,i,n){return new(i||(i=Promise))(function(r,s){function o(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(o,a)}l((n=n.apply(e,t||[])).next())})};class l{constructor(e){this.isDev=r.b,this.onMessageReceive=(e=>a(this,void 0,void 0,function*(){yield this.onMessage(e)})),this.res=e||{},this.x=this.res.x||{}}get user(){return s.c.user}get isLogined(){let{user:e}=s.c;return void 0!==e&&e.id>0}dispose(){s.c.unregisterReceiveHandler(this.receiveHandlerId),this.onDispose()}onDispose(){}openVPage(e,t){return a(this,void 0,void 0,function*(){yield new e(this).open(t)})}renderView(e,t){return new e(this).render(t)}event(e,t){return a(this,void 0,void 0,function*(){yield this.onEvent(e,t)})}onEvent(e,t){return a(this,void 0,void 0,function*(){})}msg(e){alert(e)}errorPage(e,t){this.openPage(n.createElement(o.a,{header:"App error!"},n.createElement("pre",null,"string"===typeof t?t:t.message)))}onMessage(e){}beforeStart(){return a(this,void 0,void 0,function*(){return this.registerReceiveHandler(),!0})}registerReceiveHandler(){this.receiveHandlerId=s.c.registerReceiveHandler(this.onMessageReceive)}start(e){return a(this,void 0,void 0,function*(){this.disposer=this.dispose.bind(this),!1!==(yield this.beforeStart())&&(yield this.internalStart(e))})}get isCalling(){return void 0!==this._resolve_$}call(e){return a(this,void 0,void 0,function*(){return void 0===this._resolve_$&&(this._resolve_$=[]),new Promise((t,i)=>a(this,void 0,void 0,function*(){this._resolve_$.push(t),yield this.start(e)}))})}vCall(e,t){return a(this,void 0,void 0,function*(){return void 0===this._resolve_$&&(this._resolve_$=[]),new Promise((i,n)=>a(this,void 0,void 0,function*(){this._resolve_$.push(i),yield new e(this).open(t)}))})}returnCall(e){if(void 0===this._resolve_$)return;let t=this._resolve_$.pop();void 0!==t?t(e):alert("the Coordinator call already returned, or not called")}openPage(e){s.c.push(e,this.disposer),this.disposer=void 0}replacePage(e){s.c.replace(e,this.disposer),this.disposer=void 0}backPage(){s.c.back()}closePage(e){s.c.pop(e)}ceasePage(e){s.c.ceaseTop(e)}removeCeased(){s.c.removeCeased()}regConfirmClose(e){s.c.regConfirmClose(e)}}class c{constructor(e){this.controller=e,this.res=e.res,this.x=e.x}get isDev(){return r.b}renderVm(e,t){return new e(this.controller).render(t)}openVPage(e,t){return a(this,void 0,void 0,function*(){yield new e(this.controller).open(t)})}event(e,t){return a(this,void 0,void 0,function*(){yield this.controller.event(e,t)})}returnCall(e){this.controller.returnCall(e)}openPage(e,t){this.controller.openPage(n.createElement(e,t))}replacePage(e,t){this.controller.replacePage(n.createElement(e,t))}openPageElement(e){this.controller.openPage(e)}replacePageElement(e){this.controller.replacePage(e)}backPage(){this.controller.backPage()}closePage(e){this.controller.closePage(e)}ceasePage(e){this.controller.ceasePage(e)}removeCeased(){this.controller.removeCeased()}regConfirmClose(e){this.controller.regConfirmClose(e)}}class u extends c{constructor(e){super(e)}render(e){return null}}},function(e,t,i){"use strict";var n=i(43);i.d(t,"Form",function(){return n.a});var r=i(38);i.d(t,"Field",function(){return r.a});var s=i(39);i.o(s,"Loading")&&i.d(t,"Loading",function(){return s.Loading}),i.o(s,"TabCaptionComponent")&&i.d(t,"TabCaptionComponent",function(){return s.TabCaptionComponent}),i.o(s,"Tabs")&&i.d(t,"Tabs",function(){return s.Tabs}),i.o(s,"resLang")&&i.d(t,"resLang",function(){return s.resLang}),i.o(s,"uid")&&i.d(t,"uid",function(){return s.uid});var o=i(40);i.o(o,"Loading")&&i.d(t,"Loading",function(){return o.Loading}),i.o(o,"TabCaptionComponent")&&i.d(t,"TabCaptionComponent",function(){return o.TabCaptionComponent}),i.o(o,"Tabs")&&i.d(t,"Tabs",function(){return o.Tabs}),i.o(o,"resLang")&&i.d(t,"resLang",function(){return o.resLang}),i.o(o,"uid")&&i.d(t,"uid",function(){return o.uid});i(5)},function(e,t,i){"use strict";i.d(t,"a",function(){return o});var n=i(0),r=i(26),s=i(5);class o extends n.Component{render(){let{name:e,children:t}=this.props,i=this.context;if(void 0===i)return n.createElement("span",{className:"text-danger"},"!only in Form!");let s=i.getItemSchema(e),o=Object(r.a)(i,s,t,this.props);return void 0===o?n.createElement("span",{className:"text-danger"},"!!",e," is not defined!!"):o}}o.contextType=s.a},function(e,t){},function(e,t){},function(e,t,i){"use strict";i.d(t,"a",function(){return a});var n=i(1),r=i(16),s=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},o=function(e,t,i,n){return new(i||(i=Promise))(function(r,s){function o(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(o,a)}l((n=n.apply(e,t||[])).next())})};class a{constructor(e=!1){this.isFirst=!0,this.loading=!1,this.beforeLoad=!0,this.loaded=!1,this.allLoaded=!1,this.firstSize=100,this.pageStart=void 0,this.pageSize=30,this.appendPosition="tail",this._items=n.k.array([],{deep:e})}get items(){return!0===this.beforeLoad?null:!1!==this.loaded?this._items:void 0}scrollToTop(){this.topDiv="$$"+Object(r.a)()}scrollToBottom(){this.bottomDiv="$$"+Object(r.a)()}reset(){this.isFirst=!0,this.beforeLoad=!0,this.loaded=!1,this.param=void 0,this.allLoaded=!1,this._items.clear(),this.setPageStart(void 0)}append(e){"tail"===this.appendPosition?this._items.unshift(e):this._items.push(e)}first(e){return o(this,void 0,void 0,function*(){this.reset(),this.beforeLoad=!1,this.param=e,yield this.more()})}more(){return o(this,void 0,void 0,function*(){if(!0===this.allLoaded)return;if(!0===this.loading)return;this.loading=!0;let e=this.pageSize+1;!0===this.isFirst&&this.firstSize>this.pageSize&&(e=this.firstSize+1);let t=yield this.load(this.param,this.pageStart,e);this.loading=!1,this.loaded=!0;let i=t.length;!0===this.isFirst&&i>this.firstSize||!1===this.isFirst&&i>this.pageSize?(this.allLoaded=!1,--i,t.splice(i,1)):this.allLoaded=!0,0!==i?(this.setPageStart(t[i-1]),"tail"===this.appendPosition?this._items.push(...t):this._items.unshift(...t.reverse()),this.isFirst=!1):this._items.clear()})}}s([n.k],a.prototype,"loading",void 0),s([n.k],a.prototype,"beforeLoad",void 0),s([n.k],a.prototype,"loaded",void 0),s([n.k],a.prototype,"allLoaded",void 0),s([n.d],a.prototype,"items",null),s([n.k],a.prototype,"topDiv",void 0),s([n.k],a.prototype,"bottomDiv",void 0)},function(e,t,i){"use strict";var n=i(1),r=function(e,t,i,n){return new(i||(i=Promise))(function(r,s){function o(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(o,a)}l((n=n.apply(e,t||[])).next())})};(function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);s>3&&o&&Object.defineProperty(t,i,o)})([n.k],class{constructor(e=100){this.arr=[],this.dict=new Map,this.maxCount=e}loadIds(e){let t=[];for(let i of e){if(null===i)continue;let e=this.dict.get(i);void 0===e&&(t.push(i),e={id:i},this.dict.set(i,e))}this.loadId(t)}get(e){if(void 0===e||null===e)return null;let t=this.dict.get(e);return void 0===t&&(this.dict.set(e,{id:e}),this.loadId([e]),t=this.dict.get(e)),t}setItem(e,t){void 0===t?(this.dict.set(e,null),this.arr.push({id:e})):(this.dict.set(e,t),this.arr.push(t)),this.arr.length>this.maxCount&&(t=this.arr.shift(),this.dict.delete(t.id))}loadId(e){return r(this,void 0,void 0,function*(){let t=yield this._loadIds(e);if(void 0===t)for(let i of e){if(null===i)continue;let e=yield this._loadId(i);this.setItem(i,e)}else for(let i of e){let e=t.find(e=>e.id===i);this.setItem(i,e)}})}}.prototype,"dict",void 0)},function(e,t,i){"use strict";var n=i(0),r=i(1),s=i(2),o=i.n(s),a=i(26),l=(i(33),i(5));const c={_:{required:"required",number:"not valid number",integer:"not valid integer",min:"min value is ${min}",max:"max value is ${max}"},zh:{_:{required:"\u5fc5\u987b\u586b",number:"\u9700\u8981\u6570\u5b57",integer:"\u9700\u8981\u6574\u6570",min:"\u4e0d\u80fd\u5c0f\u4e8e${min}",max:"\u4e0d\u80fd\u5927\u4e8e${max}"}}};var u=i(21);i.d(t,"a",function(){return d});class d extends n.Component{constructor(e){super(e),this.DefaultContainer=(e=>n.createElement("form",{className:o()(this.props.className)},e)),this.DefaultFieldContainer=((e,t)=>{let{fieldLabelSize:i}=this.props;if(i>0){let r;null===e?i=0:r=n.createElement("label",{className:o()("col-sm-"+i,"col-form-label")},e);let s="col-sm-"+(12-i);return n.createElement("div",{className:"form-group row"},r,n.createElement("div",{className:s},t))}return n.createElement("div",{className:"form-group"},null===e?null:n.createElement("label",{className:"col-form-label"},e),t)}),this.DefaultFieldClass=void 0,this.DefaultArrContainer=((e,t)=>n.createElement("div",null,n.createElement("div",{className:o()("small text-muted text-center bg-light py-1 px-3 mt-4 mb-1")},e),t)),this.DefaultRowContainer=(e=>{let t=o()({"py-3":!0});return n.createElement("div",{className:t},e)}),this.DefaultButtonClass="text-center py-2",this.DefaultRowSeperator=n.createElement("div",{className:"border border-gray border-top"}),this.DefaultRes=Object(u.a)(c);let{schema:t,uiSchema:i,formData:s,Container:d,FieldContainer:h,FieldClass:f,ArrContainer:p,RowContainer:v,ButtonClass:m,RowSeperator:g,res:y}=e;this.Container=d||this.DefaultContainer,this.FieldContainer=h||this.DefaultFieldContainer,this.FieldClass=void 0!==f&&""!==f&&null!==f?f:this.DefaultFieldClass,this.ArrContainer=p||this.DefaultArrContainer,this.RowContainer=v||this.DefaultRowContainer,this.res=y||this.DefaultRes,this.ButtonClass=m||this.DefaultButtonClass,this.RowSeperator=g||this.DefaultRowSeperator,this.schema=t,this.itemSchemas={},this.uiSchema=i,this.data={},void 0===s&&(s={});for(let n of t){let{name:e,type:t}=n;if(this.itemSchemas[e]=n,"button"===t);else if("arr"===t){let t=n,{arr:i}=t;if(void 0===i)continue;let o=t.itemSchemas={};for(let e of i)o[e.name]=e;let a=s[e];void 0===a?a=[{}]:!1===Array.isArray(a)&&(a=[a]);let l=[];for(let e of a){let t={};for(let n of i){let{name:i}=n,r=e[i];void 0===r&&(r=null),t[i]=r}l.push(t)}this.data[e]=Object(r.k)(l)}else this.data[e]=s[e]}void 0!==this.props.children||this.uiSchema&&this.uiSchema.Templet;let{children:b}=this.props;if(void 0!==b)this.content=n.createElement(n.Fragment,null,b),this.formContext=new l.b(this,!0);else{let e;void 0!==this.uiSchema&&(e=this.uiSchema.Templet),void 0!==e?(this.content="function"===typeof e?e(this.context):e,this.formContext=new l.b(this,!0)):(this.formContext=new l.b(this,!1),this.content=n.createElement(n.Fragment,null,this.schema.map((e,t)=>n.createElement(n.Fragment,{key:t},Object(a.a)(this.formContext,e,b)))))}}componentDidMount(){let{beforeShow:e}=this.props;void 0!==e&&e(this.formContext)}render(){return n.createElement(l.a.Provider,{value:this.formContext},n.createElement(this.formContext.renderErrors,null),this.Container(this.content))}}(function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);s>3&&o&&Object.defineProperty(t,i,o)})([r.k],d.prototype,"data",void 0)},function(e,t,i){"use strict";var n=i(0),r=i(1),s=i(9),o=i(2),a=i.n(o),l=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class c{get content(){return!0!==this.selected?this._content:void 0!==this._content?this._content:this._content=this.contentBuilder()}}l([r.k],c.prototype,"selected",void 0);const u=(e,t,i)=>n.createElement("div",{className:"d-flex justify-content-center align-items-center flex-column cursor-pointer "+i},n.createElement("div",null,n.createElement("i",{className:"fa fa-lg fa-"+t})),n.createElement("small",null,e));let d=class extends n.Component{constructor(e){super(e),this.tabs=[],this.tabClick=(e=>{this.selectedTab.selected=!1,e.selected=!0,this.selectedTab=e});let{size:t,tabs:i,tabBack:n,contentBack:r,sep:s,selected:o}=this.props;switch(t){default:case"md":this.size="3.2rem";break;case"sm":this.size="4rem";break;case"lg":this.size="2.5rem"}this.tabs.push(...i.map(e=>{let t=new c;return t.name=e.name,t.selected=!1,t.caption=e.caption,t.contentBuilder=e.content,t.notify=e.notify,t})),this.tabBack=n||"bg-light",this.contentBack=r,this.sep=s||"border-top border-gray",void 0!==o&&(this.selectedTab=this.tabs.find(e=>e.name===o)),void 0===this.selectedTab&&(this.selectedTab=this.tabs[0]),this.selectedTab.selected=!0}render(){return n.createElement("div",{className:"tab"},n.createElement("div",{className:this.contentBack,style:{height:"calc(100% - "+this.size+")"}},this.tabs.map((e,t)=>{let i={display:!0===e.selected?void 0:"none"};return n.createElement("div",{key:t,style:i},e.content)})),n.createElement("div",{className:a()(this.tabBack,this.sep),style:{height:this.size}},this.tabs.map((e,t)=>{let i,{selected:r,caption:s,notify:o}=e;if(void 0!==o){let e=o.get();void 0!==e&&(e>0?i=n.createElement("u",null,e>99?"99+":e):e<0&&(i=n.createElement("u",{className:"dot"})))}return n.createElement("div",{key:t,className:"",onClick:()=>this.tabClick(e)},n.createElement("div",{className:"align-self-center"},i,s(r)))})))}};l([r.k],d.prototype,"selectedTab",void 0),l([r.k],d.prototype,"tabs",void 0),d=l([s.a],d),i.d(t,"a",function(){return u}),i.d(t,"b",function(){return d})},function(e,t,i){"use strict";i.d(t,"a",function(){return o});var n=i(0),r=i(10),s=function(e,t,i,n){return new(i||(i=Promise))(function(r,s){function o(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(o,a)}l((n=n.apply(e,t||[])).next())})};class o extends n.Component{constructor(){super(...arguments),this.reApi=(()=>s(this,void 0,void 0,function*(){this.props.clearError();const{channel:e,url:t,options:i,resolve:n,reject:s}=this.props;yield Object(r.l)(e,t,i,n,s)})),this.close=(()=>s(this,void 0,void 0,function*(){this.props.clearError()}))}render(){let e,{error:t,url:i}=this.props;if("object"===typeof t){let i=[];for(let e in t)i.push(n.createElement("li",{key:e},n.createElement("label",null,e),n.createElement("div",null,t[e])));e=n.createElement("ul",null,i)}else e=n.createElement("div",null,t);return n.createElement("li",null,n.createElement("article",{className:"page-container"},n.createElement("section",null,n.createElement("div",{className:"va-error"},n.createElement("div",null,"\u7f51\u7edc\u51fa\u73b0\u95ee\u9898"),n.createElement("div",null,"\u70b9\u51fb\u91cd\u65b0\u8bbf\u95ee"),n.createElement("div",null,"url: ",i),e,n.createElement("div",{className:"p-3"},n.createElement("button",{type:"button",onClick:this.reApi},"\u91cd\u65b0API"),n.createElement("button",{type:"button",onClick:this.close},"\u5173\u95ed"))))))}}},function(e,t,i){},function(e,t,i){e.exports=i.p+"static/media/logo.5d5d9eef.svg"},,function(e,t,i){e.exports=i(72)},,,,,,,function(e,t,i){},,,,,,,function(e,t,i){},,function(e,t,i){},,,,,function(e,t,i){},,function(e,t,i){"use strict";i.r(t);var n=i(0),r=i(19),s=(i(54),i(56),i(4)),o=i(28),a=i(15),l=i.n(a);const c=[{name:"home",label:"\u9996\u9875",icon:"home",content:()=>{let e=l()({loader:()=>Promise.all([i.e(0),i.e(1),i.e(4)]).then(i.bind(null,155)),loading:s.Loading});return n.createElement(e,null)},notify:o.a.homeCount},{name:"member",label:"\u4f1a\u5458",icon:"vcard",content:()=>{let e=l()({loader:()=>Promise.all([i.e(0),i.e(1),i.e(5)]).then(i.bind(null,156)),loading:s.Loading,render(e,t){let i=new e.TabController;return i.start(),n.createElement(i.render,null)}});return n.createElement(e,null)}},{name:"cart",label:"\u8d2d\u7269\u8f66",icon:"shopping-cart",content:()=>{let e=l()({loader:()=>i.e(6).then(i.bind(null,157)),loading:s.Loading});return n.createElement(e,null)},notify:o.a.cartCount},{name:"me",label:"\u6211\u7684",icon:"user",content:()=>{let e=l()({loader:()=>Promise.all([i.e(0),i.e(1),i.e(7)]).then(i.bind(null,158)),loading:s.Loading});return n.createElement(e,null)}}].map(e=>{let{name:t,label:i,icon:n,content:r,notify:o}=e;return{name:t,caption:e=>Object(s.TabCaptionComponent)(i,n,(e=>!0===e?"text-primary":"text-muted")(e)),content:r,notify:o}});var u=function(e,t,i,n){return new(i||(i=Promise))(function(r,s){function o(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(o,a)}l((n=n.apply(e,t||[])).next())})};var d=class extends n.Component{render(){let e=n.createElement(s.Page,{header:!1},n.createElement(s.Tabs,{tabs:c}));return n.createElement(s.NavView,{onLogined:()=>u(this,void 0,void 0,function*(){return s.nav.push(e)}),notLogined:()=>u(this,void 0,void 0,function*(){return s.nav.push(e)})})}};i(70);const h=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function f(e){navigator.serviceWorker.register(e).then(e=>{e.onupdatefound=(()=>{const t=e.installing;t&&(t.onstatechange=(()=>{"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}))})}).catch(e=>{console.error("Error during service worker registration:",e)})}r.render(n.createElement(d,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL(".",window.location.toString()).origin!==window.location.origin)return;window.addEventListener("load",()=>{const e="./service-worker.js";h?(function(e){fetch(e).then(t=>{404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(e=>{e.unregister().then(()=>{window.location.reload()})}):f(e)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):f(e)})}}()}],[[49,10,9]]]);
//# sourceMappingURL=main.eefbfa10.chunk.js.map